default_platform(:android)

platform :android do
  desc "Increase version number"
  lane :bump do |options|
    android_set_version_code
    if options[:version] && options[:version] != ""
      android_set_version_name(
        version_name: options[:version]
      )
    end

    # Write version to record file
    version_num = android_get_version_code
    version_name = android_get_version_name
    sh("echo 'Release #{version_name} (#{version_num})' > ../../version.txt")
  end

  desc "Submit a new build to Play Store (Alpha Track)"
  lane :build do
    # Compile release version of code
    gradle(
      task: "clean assembleRelease",
      flags: "-Dorg.gradle.internal.http.socketTimeout=120000 -Dorg.gradle.internal.http.connectionTimeout=120000"
    )
  end
end
